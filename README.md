## Google Cloud Media CDN: CloudFront Signed URL Verifier
This repository contains a Google Cloud Service Extensions Code Sample designed to provide interoperability between Google Cloud Media CDN and Amazon CloudFront.

Specifically, this code allows Media CDN to validate and authenticate signed URLs generated by Amazon CloudFront, enabling a smoother migration or a multi-CDN delivery strategy.

### The Problem
By default, Google Cloud Media CDN uses its own signed URL format (based on signed cookies or tokens) to secure content. Amazon CloudFront uses a different, incompatible format for its signed URLs.

This creates a significant interoperability challenge for organizations that:

1. Are migrating from CloudFront to Media CDN and want to honor existing, unexpired URLs.

1. Operate a multi-CDN strategy and require a consistent URL signing mechanism.

1. Have client applications that are already configured to generate CloudFront-style signed URLs.

### The Solution
This project provides a Service Extensions WASM plugin code example that intercepts incoming requests to your Media CDN service. It acts as a custom authenticator.

When a request is received, the extension:

1. Parses the request URI for CloudFront-specific query parameters (Expires, Signature, Key-Pair-Id).

2. Fetches the corresponding public key (associated with the Key-Pair-Id) from the Plugin Configuration Data.

3. Constructs the "canonical" string that CloudFront would use for signing.

4. Uses the public key to verify the Signature against the canonical string.

5. If validation is successful, the extension allows the request to proceed to the Media CDN cache/origin.

6. If validation fails (e.g., expired timestamp, invalid signature), the extension instructs Media CDN to return a 403 Forbidden error.

## Benefits
1. CloudFront URL Validation: Natively validates CloudFront V2 signed URLs.

1. Seamless Interoperability: Allows clients to use CloudFront-generated tokens to access content served by Google Media CDN.

1. Lightweight & Fast: Designed to run with minimal latency as part of the Media CDN request flow.